<?xml version="1.0" encoding="utf-8" ?>
<nlog xmlns="http://www.nlog-project.org/schemas/NLog.xsd"
      xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
      autoReload="true"
      throwExceptions="false"
      internalLogLevel="Off">

  <!-- 로그 저장 위치 및 형식 정의 -->
  <targets>
    <!-- 모든 로그를 파일에 저장 (날짜별 분리) -->
    <target xsi:type="File"
            name="allfile"
            fileName="${basedir}/Logs/${shortdate}_all.log"
            layout="${longdate} [${uppercase:${level}}] ${logger} - ${message} ${exception:format=tostring}"
            encoding="utf-8"
            archiveFileName="${basedir}/Logs/archives/${shortdate}_all_{#}.log"
            archiveEvery="Day"
            archiveNumbering="Rolling"
            maxArchiveFiles="30"
            concurrentWrites="true"
            keepFileOpen="false" />

    <!-- 에러 이상 레벨만 별도 파일에 저장 -->
    <target xsi:type="File"
            name="errorfile"
            fileName="${basedir}/Logs/${shortdate}_error.log"
            layout="${longdate} [${uppercase:${level}}] ${logger} - ${message} ${exception:format=tostring}"
            encoding="utf-8"
            archiveFileName="${basedir}/Logs/archives/${shortdate}_error_{#}.log"
            archiveEvery="Day"
            archiveNumbering="Rolling"
            maxArchiveFiles="30"
            concurrentWrites="true"
            keepFileOpen="false" />

    <!-- 콘솔 출력 (디버깅용) -->
    <target xsi:type="Console"
            name="console"
            layout="${time} [${uppercase:${level}}] ${message} ${exception:format=tostring}" />

    <!-- 디버그 출력 -->
    <target xsi:type="Debugger"
            name="debugger"
            layout="${time} [${uppercase:${level}}] ${message}" />
  </targets>

  <!-- 로그 레벨별 규칙 정의 -->
  <rules>
    <!-- Trace 이상의 모든 로그를 파일에 저장 -->
    <logger name="*" minlevel="Trace" writeTo="allfile" />

    <!-- Error 이상의 로그를 별도 에러 파일에 저장 -->
    <logger name="*" minlevel="Error" writeTo="errorfile" />

    <!-- Debug 빌드에서는 콘솔에도 출력 -->
    <logger name="*" minlevel="Debug" writeTo="console" />

    <!-- 디버거 출력 -->
    <logger name="*" minlevel="Trace" writeTo="debugger" />
  </rules>
</nlog>
